"use strict";(self.webpackChunklaghata_frontend=self.webpackChunklaghata_frontend||[]).push([[110],{2211:function(n,e,t){t.r(e),t.d(e,{default:function(){return X}});var r,i,a,o,s,c,d,l,u,p,f,x,h,v,g,m,Z,b,w=t(168),k=t(4165),j=t(5861),y=t(2982),P=t(885),_=t(2791),I=t(7691),C=t(184),S=I.ZP.div(r||(r=(0,w.Z)(["\n  margin: 0px 15px;\n  padding: 20px;\n  width: fit-content;\n  cursor: pointer;\n  transition: all 0.5s ease-in-out;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 13px;\n  position: relative;\n\n  :hover {\n    background-color: #f5f0ed;\n  }\n"]))),E=I.ZP.img(i||(i=(0,w.Z)(["\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n"]))),D=I.ZP.p(a||(a=(0,w.Z)(["\n  font-weight: 700px;\n"]))),N=I.ZP.span(o||(o=(0,w.Z)(["\n  width: 19px;\n  height: 19px;\n  border-radius: 50%;\n  background: white;\n  color: black;\n  position: absolute;\n  top: 15px;\n\n  right: 13px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),z=function(n){var e=n.conversation,t=n.currentUserId,r=n.setCurrentChatConversation,i=n.setClientPicture,a=n.setNotification,o=n.notification,s=(0,_.useState)(null),c=(0,P.Z)(s,2),d=c[0],l=c[1];(0,_.useEffect)((function(){var n=e.members.find((function(n){return n!==t})),r=function(){var e=(0,j.Z)((0,k.Z)().mark((function e(){var t,r;return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=9;break}return e.next=4,fetch("".concat("https://laghata-app.herokuapp.com","/api/user/").concat(n));case 4:return t=e.sent,e.next=7,t.json();case 7:(r=e.sent).data&&(l(r.data),i(r.data.picture));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.stack);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();r()}),[t,e]);var u=0;o&&d&&o.map((function(n){return n.senderId===d._id&&(u+=1),u}));return(0,C.jsxs)(S,{onClick:function(){r(e),a(o.filter((function(n){return n.senderId!==d._id})))},children:[(0,C.jsx)(E,{src:null===d||void 0===d?void 0:d.picture}),u>0&&(0,C.jsx)(N,{children:u}),(0,C.jsx)(D,{children:null===d||void 0===d?void 0:d.username})]},e._id)},R=t(6599),F=t(7692),M=t(4798),A=t(4827),K=I.ZP.div(s||(s=(0,w.Z)(["\n  min-height: 100vh;\n  background-color: #f5f0ed;\n  position: relative;\n"]))),O=I.ZP.div(c||(c=(0,w.Z)(["\n  max-width: 950px;\n  width: 90%;\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n\n  .spinner {\n    margin-top: 60px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n"]))),T=I.ZP.div(d||(d=(0,w.Z)(["\n  display: flex;\n  align-items: flex-start;\n  gap: 15px;\n"]))),U=I.ZP.span(l||(l=(0,w.Z)(["\n  font-size: 50px;\n  width: 100%;\n  text-align: center;\n  color: #f5f5f3;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n\n  @media screen and (max-width: 700px) {\n    font-size: 35px;\n  }\n"]))),q=I.ZP.div(u||(u=(0,w.Z)(['\n  margin: 20px 0;\n  padding: 10px;\n  height: 70vh;\n  background-image: url("https://cdn.wallpapersafari.com/19/15/HlpKYq.png");\n  background-size: contain;\n  position: relative;\n  border-radius: 25px;\n\n  @media screen and (max-width: 700px) {\n    height: 60vh;\n  }\n']))),H=I.ZP.div(p||(p=(0,w.Z)([""]))),J=I.ZP.div(f||(f=(0,w.Z)(["\n  display: flex;\n  flex-direction: column;\n  padding: 9px 10px;\n"]))),L=I.ZP.div(x||(x=(0,w.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  gap: 7px;\n  padding-top: 13px;\n"]))),V=I.ZP.div(h||(h=(0,w.Z)(["\n  display: flex;\n  align-items: center;\n  gap: 5px;\n"]))),Y=I.ZP.img(v||(v=(0,w.Z)(["\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n"]))),B=I.ZP.div(g||(g=(0,w.Z)(["\n  overflow-x: hidden;\n  overflow-y: scroll;\n  height: 90%;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #f5f0ed;\n    border-radius: 50px;\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #f5f0ed;\n    border-radius: 50px;\n  }\n\n  @media screen and (max-width: 700px) {\n    height: 85%;\n  }\n"]))),G=I.ZP.div(m||(m=(0,w.Z)(["\n  background-color: #fff;\n  width: fit-content;\n  border-radius: 25px;\n  padding: 10px 12px;\n  font-size: 15px;\n  font-weight: 400;\n"]))),Q=I.ZP.input(Z||(Z=(0,w.Z)(["\n  position: absolute;\n  bottom: 7px;\n  left: 10px;\n  padding-left: 9px;\n  width: 90%;\n  height: 40px;\n  outline: none;\n  border-radius: 25px;\n  border: 1px solid white;\n  color: white;\n  background-color: transparent;\n\n  @media screen and (max-width: 700px) {\n    width: 80%;\n  }\n"]))),W=I.ZP.button(b||(b=(0,w.Z)(["\n  border: 1px solid white;\n  .sendIcon {\n    font-size: 40px;\n    color: #f5f0ed;\n    position: absolute;\n    bottom: 10px;\n    right: 20px;\n    border-radius: 50%;\n    border: none;\n    background-color: transparent;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n"]))),X=function(){var n=(0,_.useContext)(R.p),e=n.socket,t=n.setNotification,r=n.notification,i=(0,A.a)(),a=(0,_.useState)(!1),o=(0,P.Z)(a,2),s=o[0],c=o[1],d=(0,_.useState)([]),l=(0,P.Z)(d,2),u=l[0],p=l[1],f=(0,_.useState)(null),x=(0,P.Z)(f,2),h=x[0],v=x[1],g=(0,_.useState)([]),m=(0,P.Z)(g,2),Z=m[0],b=m[1],w=(0,_.useState)(""),I=(0,P.Z)(w,2),S=I[0],E=I[1],D=(0,_.useState)(""),N=(0,P.Z)(D,2),X=N[0],$=N[1],nn=(0,_.useState)(),en=(0,P.Z)(nn,2),tn=en[0],rn=en[1],an=(0,_.useRef)();(0,_.useEffect)((function(){e&&(null===e||void 0===e||e.on("getMessage",(function(n){$({senderId:n.senderId,text:n.text,createdAt:new Date(Date.now())})})))}),[e]),(0,_.useEffect)((function(){X&&(null===h||void 0===h?void 0:h.members.includes(X.senderId))&&b((function(n){return[].concat((0,y.Z)(n),[X])}))}),[X,h]),(0,_.useEffect)((function(){try{var n=function(){var n=(0,j.Z)((0,k.Z)().mark((function n(){var e,t;return(0,k.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat("https://laghata-app.herokuapp.com","/api/conversation/").concat(null===i||void 0===i?void 0:i._id));case 2:return e=n.sent,n.next=5,e.json();case 5:(t=n.sent).data.length>0&&p(t.data);case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}catch(e){console.log(e.stack)}}),[null===i||void 0===i?void 0:i._id]),(0,_.useEffect)((function(){c(!0);var n=function(){var n=(0,j.Z)((0,k.Z)().mark((function n(){var e,t;return(0,k.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("".concat("https://laghata-app.herokuapp.com","/api/messages/").concat(null===h||void 0===h?void 0:h._id));case 3:return e=n.sent,n.next=6,e.json();case 6:(t=n.sent).data.length>0&&(b(t.data),c(!1)),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),console.log(n.t0.stack),c(!1);case 14:c(!1);case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}}();n()}),[h]);var on=function(){var n=(0,j.Z)((0,k.Z)().mark((function n(t){var r,a,o;return(0,k.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),r=h.members.find((function(n){return n!==(null===i||void 0===i?void 0:i._id)})),a={senderId:null===i||void 0===i?void 0:i._id,text:S,receiverId:r,conversationId:h._id,createAt:new Date(Date.now())},e.emit("sendMessage",{senderId:null===i||void 0===i?void 0:i._id,receiverId:r,text:S}),E(""),n.prev=5,o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},n.next=9,fetch("".concat("https://laghata-app.herokuapp.com","/api/message"),o);case 9:n.sent.ok&&b([].concat((0,y.Z)(Z),[a])),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(5),console.log(n.t0.stack);case 16:case"end":return n.stop()}}),n,null,[[5,13]])})));return function(e){return n.apply(this,arguments)}}();return(0,_.useEffect)((function(){var n;null===(n=an.current)||void 0===n||n.scrollIntoView({behavior:"smooth"})}),[Z]),(0,C.jsx)(K,{children:(0,C.jsx)(O,{children:u&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(T,{children:u.map((function(n){return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(z,{conversation:n,currentUserId:null===i||void 0===i?void 0:i._id,setCurrentChatConversation:v,setClientPicture:rn,setNotification:t,notification:r},n._id)})}))}),s?(0,C.jsx)(M.p2,{height:"30",width:"30",color:"#242526",ariaLabel:"circles-loading",wrapperClass:"spinner",visible:!0}):(0,C.jsx)(q,{children:h?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(B,{children:Z.map((function(n,e){return(0,C.jsx)(J,{children:n.senderId!==(null===i||void 0===i?void 0:i._id)?(0,C.jsxs)(L,{children:[(0,C.jsx)(G,{children:n.text}),(0,C.jsx)(Y,{src:tn,alt:"RenterProfile"})]},n._id):(0,C.jsxs)(V,{children:[(0,C.jsx)(Y,{src:null===i||void 0===i?void 0:i.picture,alt:"RenterProfile"}),(0,C.jsx)(G,{children:n.text})]},n._id)},e)}))}),(0,C.jsxs)(H,{onSubmit:on,children:[(0,C.jsx)(Q,{value:S,placeholder:"Message",onChange:function(n){return E(n.target.value)},onKeyDown:function(n){return"Enter"===n.key?on(n):null}}),(0,C.jsx)(W,{type:"submit",children:(0,C.jsx)(F.PRb,{className:"sendIcon"})})]})]}):(0,C.jsx)(U,{children:"No chat selected"})})]})})})}}}]);
//# sourceMappingURL=110.bc082222.chunk.js.map